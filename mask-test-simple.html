<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¢å…·ä¹‹é­‚ï¼šæ¢å¯»ä½ çš„éæ´²éƒ¨è½åŒ–èº«</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Gochi+Hand&family=Nunito:wght@400;700;900&family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <style>
      body {
        font-family: 'Nunito', 'PingFang SC', 'Microsoft YaHei', 'Heiti SC', sans-serif;
        background-color: #fdfbf7;
        overflow: hidden; 
        touch-action: none;
      }
      .font-hand {
        font-family: 'Gochi Hand', 'ZCOOL KuaiLe', 'YouYuan', 'Microsoft YaHei', sans-serif;
      }
      
      .bg-notebook-paper {
        background-color: #fdfbf7;
        background-image: linear-gradient(#e5e7eb 1px, transparent 1px);
        background-size: 100% 24px;
      }

      @keyframes bounce-move {
        0%, 100% { transform: translateY(0) scale(1); }
        50% { transform: translateY(-8px) scale(1.05); }
      }
      .animate-bounce-move {
        animation: bounce-move 0.4s infinite linear;
      }

      @keyframes leg-swing {
        0%, 100% { transform: rotate(-25deg); }
        50% { transform: rotate(25deg); }
      }
      @keyframes leg-swing-opp {
        0%, 100% { transform: rotate(25deg); }
        50% { transform: rotate(-25deg); }
      }
      
      @keyframes arm-swing {
        0%, 100% { transform: rotate(20deg); }
        50% { transform: rotate(-20deg); }
      }
      @keyframes arm-swing-opp {
        0%, 100% { transform: rotate(-20deg); }
        50% { transform: rotate(20deg); }
      }

      .animate-leg {
        animation: leg-swing 0.8s infinite ease-in-out;
      }
      .animate-leg-opp {
        animation: leg-swing-opp 0.8s infinite ease-in-out;
      }
      .animate-arm {
        animation: arm-swing 0.8s infinite ease-in-out;
      }
      .animate-arm-opp {
        animation: arm-swing-opp 0.8s infinite ease-in-out;
      }

      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }
      
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
    </style>
</head>
<body>
    <div id="app" class="relative w-full h-screen bg-stone-200 overflow-hidden flex justify-center font-hand">
        <div class="relative w-full max-w-[480px] h-full bg-orange-50 shadow-2xl overflow-hidden">
            <div id="gameContainer" class="relative w-full h-full"></div>
        </div>
    </div>

    <script>
        // Game Data
        const WORLD_HEIGHT = 4200;
        
        const QUESTIONS = [
            {
                id: 1,
                text: "ç¬¬ä¸€é¢˜ï¼šä½ å¦‚ä½•çœ‹å¾…è‡ªå·±åœ¨ç¤¾ç¾¤ä¸­çš„è§’è‰²ï¼Ÿ",
                options: [
                    { text: "A. å®ˆæŠ¤è€…ã€‚æˆ‘æœ¬èƒ½åœ°ä¿æŠ¤èº«è¾¹çš„äººï¼Œç»´æŠ¤ç§©åºä¸æ­£ä¹‰ï¼Œæ˜¯å¤§å®¶ä¿¡èµ–çš„ä¾é ", type: 'A' },
                    { text: "B. æ™ºè€…ã€‚æˆ‘ä¹äºæ€è€ƒä¸ä¼ æˆçŸ¥è¯†ï¼Œæ˜¯è¿æ¥è¿‡å»ä¸æœªæ¥çš„æ¡¥æ¢ï¼Œå¸¸ä¸ºä»–äººæŒ‡å¼•æ–¹å‘", type: 'B' },
                    { text: "C. æ²Ÿé€šè€…ã€‚æˆ‘æ“…é•¿åè°ƒçŸ›ç›¾ï¼Œä¼ é€’ä¿¡æ¯ï¼Œæ˜¯ä¿ƒè¿›ç¾¤ä½“å’Œè°ä¸ç†è§£çš„çº½å¸¦", type: 'C' },
                    { text: "D. æ²»æ„ˆè€…ã€‚æˆ‘å……æ»¡åŒç†å¿ƒï¼Œèƒ½æŠšæ…°ä»–äººæƒ…ç»ªï¼Œå¹¶çƒ­çˆ±è‡ªç„¶ä¸ç”Ÿå‘½çš„åŠ›é‡", type: 'D' },
                ]
            },
            {
                id: 2,
                text: "ç¬¬äºŒé¢˜ï¼šå“ªç§åŠ›é‡æœ€è®©ä½ å¿ƒç”Ÿå‘å¾€ï¼Ÿ",
                options: [
                    { text: "A. é›„ç‹®çš„å‹‡æ°”ã€‚æ— ç•ã€å¼ºå¤§ï¼Œæ‹¥æœ‰å¾æœä¸€åˆ‡å›°éš¾çš„å†³å¿ƒ", type: 'A' },
                    { text: "B. çŒè±¹çš„çµå·§ã€‚æ•æ·ã€ç²¾å‡†ï¼Œæ€»èƒ½æ´å¯Ÿå…ˆæœºï¼Œæ‰¾åˆ°æœ€ä½³è·¯å¾„", type: 'B' },
                    { text: "C. å¤§è±¡çš„æ™ºæ…§ã€‚æ²‰ç¨³ã€é•¿å¯¿ï¼Œæ‹¥æœ‰å¤è€çš„è®°å¿†å’Œå®¶æ—å‡èšåŠ›", type: 'C' },
                    { text: "D. é›¨æ°´çš„æ»‹å…»ã€‚æ¸©æŸ”ã€æ½œç§»é»˜åŒ–ï¼Œèƒ½å¸¦æ¥æ–°ç”Ÿä¸å¸Œæœ›", type: 'D' },
                ]
            },
            {
                id: 3,
                text: "ç¬¬ä¸‰é¢˜ï¼šé¢å¯¹ä¸€ä¸ªæœªçŸ¥çš„æŒ‘æˆ˜ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ",
                options: [
                    { text: "A. æ­£é¢è¿æ¥ã€‚åˆ¶å®šè®¡åˆ’ï¼Œé›†ç»“åŠ›é‡ï¼Œç›´æ¥è€Œæœæ–­åœ°è§£å†³é—®é¢˜", type: 'A' },
                    { text: "B. æ·±å…¥æ´å¯Ÿã€‚å…ˆè§‚å¯Ÿã€åˆ†æï¼Œç†è§£å…¶æœ¬è´¨å’Œè§„å¾‹ï¼Œå†å¯»æ±‚ç ´è§£ä¹‹é“", type: 'B' },
                    { text: "C. å¯»æ±‚åä½œã€‚è”ç³»åŒä¼´ï¼Œäº¤æ¢ä¿¡æ¯ï¼Œé›†åˆä¼—äººçš„æ™ºæ…§å…±åŒé¢å¯¹", type: 'C' },
                    { text: "D. é¡ºåº”èŠ‚å¥ã€‚è°ƒæ•´è‡ªèº«çŠ¶æ€ï¼Œåƒæ°´ä¸€æ ·æµåŠ¨ï¼Œåœ¨é€‚åº”ä¸­æ‰¾åˆ°æœºä¼š", type: 'D' },
                ]
            },
            {
                id: 4,
                text: "ç¬¬å››é¢˜ï¼šä½ å¸Œæœ›ä»–äººå¦‚ä½•è®°ä½ä½ ï¼Ÿ",
                options: [
                    { text: "A. ä¸€ä¸ªå¼ºå¤§çš„ä¼ å¥‡ã€‚æˆ‘çš„å­˜åœ¨æœ¬èº«ï¼Œå°±æ˜¯ä¸€ç§åŠ›é‡å’Œåº‡æŠ¤", type: 'A' },
                    { text: "B. ä¸€ä¸ªæ™ºæ…§çš„æºæ³‰ã€‚æˆ‘çš„æ€æƒ³å’Œè¯è¯­ï¼Œèƒ½æŒç»­å¯å‘åäºº", type: 'B' },
                    { text: "C. ä¸€ä¸ªå’Œè°çš„è±¡å¾ã€‚æˆ‘è®©ä¸–ç•Œå˜å¾—æ›´åŠ åŒ…å®¹ä¸ç¾å¥½", type: 'C' },
                    { text: "D. ä¸€ä¸ªç”Ÿå‘½çš„ç¤¼èµã€‚æˆ‘å¸¦æ¥äº†æ¬¢ä¹ã€æ²»æ„ˆä¸è¿æ¥", type: 'D' },
                ]
            },
            {
                id: 5,
                text: "ç¬¬äº”é¢˜ï¼šåœ¨ç¤¾äº¤åœºåˆä¸­ï¼Œä½ é€šå¸¸æ˜¯ï¼Ÿ",
                options: [
                    { text: "A. è¯é¢˜ä¸»å¯¼è€…ã€‚èƒ½è‡ªç„¶åœ°å¼•é¢†å¯¹è¯èŠ‚å¥ï¼Œæ°”åœºå¼ºå¤§", type: 'A' },
                    { text: "B. æ·±åº¦å‰–æè€…ã€‚å–œæ¬¢è¿›è¡Œæœ‰æ„ä¹‰çš„å¯¹è¯ï¼Œå¹¶æå‡ºç‹¬ç‰¹è§è§£", type: 'B' },
                    { text: "C. æ°›å›´è°ƒèŠ‚è€…ã€‚å…³æ³¨æ¯ä¸ªäººçš„æ„Ÿå—ï¼Œç¡®ä¿åœºé¢å’Œè°æ„‰å¿«", type: 'C' },
                    { text: "D. å®‰é™å€¾å¬è€…ã€‚å–„äºç†è§£ä»–äººï¼Œå¹¶æä¾›æ¸©æš–çš„é™ªä¼´å’Œæ”¯æŒ", type: 'D' },
                ]
            },
            {
                id: 6,
                text: "ç¬¬å…­é¢˜ï¼šä½ æ›´åçˆ±å“ªç§åˆ›ä½œæ–¹å¼ï¼Ÿ",
                options: [
                    { text: "A. æ„å»ºå®å¤§çš„ä½“ç³»ã€‚æ¯”å¦‚ç­–åˆ’ä¸€ä¸ªé¡¹ç›®ï¼Œæ­å»ºä¸€ä¸ªæ¸…æ™°çš„æ¡†æ¶", type: 'A' },
                    { text: "B. è§£æ„å¤æ‚çš„æ¦‚å¿µã€‚æ¯”å¦‚ç ”ç©¶ç†è®ºï¼Œå°†æŠ½è±¡äº‹ç‰©å…·è±¡åŒ–", type: 'B' },
                    { text: "C. ç¼–ç»‡ç²¾å¦™çš„æ•…äº‹ã€‚æ¯”å¦‚é€šè¿‡å™è¿°æ¥è¿æ¥äººä¸äººä¹‹é—´çš„æƒ…æ„Ÿ", type: 'C' },
                    { text: "D. æ„Ÿå—å³å…´çš„çµæ„Ÿã€‚æ¯”å¦‚éšå¿ƒçš„æ¶‚é¸¦ã€éŸ³ä¹æˆ–èˆè¹ˆï¼Œè¡¨è¾¾ç¬é—´çš„æƒ…ç»ª", type: 'D' },
                ]
            },
            {
                id: 7,
                text: "ç¬¬ä¸ƒé¢˜ï¼šä½ è®¤ä¸ºä»€ä¹ˆæ˜¯ç†æƒ³çš„ç¤¾åŒºï¼Ÿ",
                options: [
                    { text: "A. çºªå¾‹ä¸¥æ˜çš„å ¡å’ã€‚å®‰å…¨ã€æœ‰åºï¼Œæ‹¥æœ‰å¼ºå¤§çš„é˜²å¾¡å’Œè§„åˆ™", type: 'A' },
                    { text: "B. æ€æƒ³è‡ªç”±çš„å­¦åŸã€‚é¼“åŠ±æ¢ç´¢çŸ¥è¯†ï¼Œå°Šé‡æ™ºæ…§å’Œåˆ›æ–°", type: 'B' },
                    { text: "C. å¹³ç­‰äº’åŠ©çš„è”ç›Ÿã€‚æ²¡æœ‰éš”é˜‚ï¼Œäººä»¬é€šè¿‡æ²Ÿé€šè¾¾æˆå…±è¯†", type: 'C' },
                    { text: "D. äº²è¿‘è‡ªç„¶çš„éƒ¨è½ã€‚ä¸ç¯å¢ƒå’Œè¯¸å…±å¤„ï¼Œç”Ÿæ´»èŠ‚å¥é¡ºåº”å¤©åœ°", type: 'D' },
                ]
            },
            {
                id: 8,
                text: "ç¬¬å…«é¢˜ï¼šä½ å¦‚ä½•å®šä¹‰è‡ªå·±çš„ç¾ï¼Ÿ",
                options: [
                    { text: "A. åŠ›é‡ä¹‹ç¾ã€‚ä½“ç°åœ¨åšéŸ§ã€æœæ–­å’Œå®é™…çš„æˆå°±ä¸Š", type: 'A' },
                    { text: "B. æ™ºæ…§ä¹‹ç¾ã€‚ä½“ç°åœ¨æ·±é‚ƒçš„æ€æƒ³ã€æ´å¯ŸåŠ›å’Œåˆ›é€ åŠ›ä¸Š", type: 'B' },
                    { text: "C. å’Œè°ä¹‹ç¾ã€‚ä½“ç°åœ¨ä¼˜é›…çš„ä¸¾æ­¢ã€å¾—ä½“çš„è¨€è¡Œå’Œå¹³è¡¡æ„Ÿä¸Š", type: 'C' },
                    { text: "D. æœ¬çœŸä¹‹ç¾ã€‚ä½“ç°åœ¨è´¨æœ´çš„å†…å¿ƒã€çœŸå®çš„æƒ…æ„Ÿå’Œç”Ÿå‘½åŠ›ä¸Š", type: 'D' },
                ]
            }
        ];

        const ASSETS = {
            avatar: "ğŸ—¿", 
            totems: ["ğŸ¦", "ğŸº", "ğŸ", "ğŸ”¥", "ğŸ¥", "ğŸ­", "ğŸ¦…", "ğŸŒ"],
            trees: ["ğŸŒ³", "ğŸŒ´", "ğŸŒµ", "ğŸŒ¿"],
            houses: ["ğŸ›–", "â›º"],
            rocks: ["ğŸª¨", "â›°ï¸"],
        };

        const WAYPOINTS = [
            { pos: { x: 50, y: 320 } },
            { pos: { x: 20, y: 450 }, questionId: 1, totem: ASSETS.totems[0] },
            { pos: { x: 80, y: 750 }, questionId: 2, totem: ASSETS.totems[1] },
            { pos: { x: 30, y: 1100 }, questionId: 3, totem: ASSETS.totems[2] },
            { pos: { x: 70, y: 1450 }, questionId: 4, totem: ASSETS.totems[3] },
            { pos: { x: 25, y: 1850 }, questionId: 5, totem: ASSETS.totems[4] },
            { pos: { x: 75, y: 2200 }, questionId: 6, totem: ASSETS.totems[5] },
            { pos: { x: 20, y: 2600 }, questionId: 7, totem: ASSETS.totems[6] },
            { pos: { x: 50, y: 3000 }, questionId: 8, totem: ASSETS.totems[7] },
            { pos: { x: 50, y: 3400 }, isEnd: true },
        ];

        const RESULTS = {
            '1': {
                id: '1',
                name: "åˆšæœç‹å›½ Â· æ©åŸºè¥¿å‹‡å£«é¢å…·",
                title: "å®ˆæŠ¤å‹äººæ ¼ Â· ç§©åºé“æ‹³",
                trait: "æƒå¨",
                strength: "è£å†³",
                skill: "ä¸»æŒå…¬é“",
                desc: "ä½ æ˜¯éƒ¨è½è§„åˆ™çš„åŒ–èº«ï¼Œå…¬æ­£çš„æå«è€…ã€‚æ°”åœºè‡ªå¸¦è¾¹ç•Œæ„Ÿï¼Œèƒ½é•‡ä½ä¸€åˆ‡éªšåŠ¨ï¼Œæ˜¯è®©äººå®‰å¿ƒæ‰˜ä»˜çš„äººé—´ç§¤ç £ã€‚",
                color: "bg-red-100",
                icon: "ğŸ›¡ï¸"
            },
            '2': {
                id: '2',
                name: "ç­å·´æ‹‰éƒ¨è½ Â· å¥‘ç“¦æ‹‰ç¾šç¾Šé¡¶é¥°",
                title: "åˆ›é€ å‹äººæ ¼ Â· ä¸°é¥¶å¤§å¸ˆ",
                trait: "å‹¤å¥‹",
                strength: "é«˜äº§",
                skill: "ç‚¹åœŸæˆé‡‘",
                desc: "ä½ çš„åˆ›é€ åŠ›å¦‚åŒæ²ƒåœŸï¼Œæ€»èƒ½å­•è‚²å‡ºæƒŠè‰³çš„æœå®ã€‚æ˜¯å¤©ç”Ÿçš„å»ºè®¾è€…ï¼Œåœ¨ä½ èº«è¾¹æ€»èƒ½æ„Ÿå—åˆ°ä¸‡ç‰©ç”Ÿé•¿çš„è“¬å‹ƒæœæ°”ã€‚",
                color: "bg-green-100",
                icon: "ğŸŒ¾"
            },
            '3': {
                id: '3',
                name: "å¤šè´¡éƒ¨è½ Â· å¤§é¢å…·",
                title: "å“²æ€å‹äººæ ¼ Â· å®‡å®™æ¨¡ç»„",
                trait: "æ·±é‚ƒ",
                strength: "æ´å¯Ÿ",
                skill: "å‚é€æœ¬è´¨",
                desc: "ä½ çš„ç²¾ç¥è¿æ¥ç€æ˜Ÿè¾°ä¸å¤è€æ™ºæ…§ã€‚å–œæ¬¢æ¢å¯»ä¸‡ç‰©è§„å¾‹ï¼Œæ˜¯æœ‹å‹ä¸­è¡Œèµ°çš„ç™¾ç§‘åœ£å…‰ï¼Œæ€»èƒ½å¸¦æ¥é™ç»´æ‰“å‡»çš„å¯å‘ã€‚",
                color: "bg-indigo-100",
                icon: "ğŸŒŒ"
            },
            '4': {
                id: '4',
                name: "é²å‹’éƒ¨è½ Â· äººé¢ç¥çµé¢å…·",
                title: "å’Œè°å‹äººæ ¼ Â· ç¾å­¦æ ‡æ†",
                trait: "ä¼˜é›…",
                strength: "å¹³è¡¡",
                skill: "é¢œå€¼ç»´ç¨³",
                desc: "ä½ å´‡å°šå¹¶åˆ›é€ ç€ä¸€åˆ‡å½¢å¼çš„ç¾ä¸å’Œè°ã€‚æ˜¯ç¤¾äº¤åœˆé‡Œçš„å®šæµ·ç¥é’ˆï¼Œèƒ½ç”¨æ¸©æŸ”çš„åŠ›é‡æŠšå¹³æ¯›èºï¼Œè®©ä¸–ç•Œå˜å¾—ä¼˜é›…ä»å®¹ã€‚",
                color: "bg-pink-100",
                icon: "ğŸ­"
            },
            '5': {
                id: '5',
                name: "å¡åŠªç¦éƒ¨è½ Â· ç«æ³•å¸ˆé¢å…·",
                title: "åŠ›é‡å‹äººæ ¼ Â· é‡æ€§å›¾è…¾",
                trait: "ç‹‚é‡",
                strength: "å¨æ…‘",
                skill: "æ°”åœºå…¨å¼€",
                desc: "ä½ ä½“å†…å°å°ç€æœ€åŸå§‹çš„ç”Ÿå‘½åŠ›ï¼Œæ— ç•ä¸”å¼ºå¤§ã€‚æ˜¯æ”»åšå…‹éš¾çš„ä¸äºŒäººé€‰ï¼Œæ‹¥æœ‰ç”¨è¡ŒåŠ¨ç²‰ç¢ä¸€åˆ‡éšœç¢çš„ç¡¬æ ¸é­…åŠ›ã€‚",
                color: "bg-orange-100",
                icon: "ğŸ”¥"
            },
            '6': {
                id: '6',
                name: "é©¬åº·å¾·éƒ¨è½ Â· è°¢å¡”å°¼é¢å…·",
                title: "çµæ„Ÿå‹äººæ ¼ Â· æ¢¦å¢ƒæ•æ‰‹",
                trait: "æŠ½è±¡",
                strength: "åˆ›æ„",
                skill: "è„‘æ´å¼€èŠ±",
                desc: "ä½ çš„æ€ç»´ä¸å—é‡åŠ›æŸç¼šï¼Œæ˜¯å¤©ç”Ÿçš„å¹»æƒ³å»ºç­‘å¸ˆã€‚æ€»èƒ½ä»å¼‚æ¬¡å…ƒå¸¦æ¥æƒŠå–œï¼Œæ˜¯å›¢é˜Ÿé‡Œä¸å¯æˆ–ç¼ºçš„çµæ„Ÿæ°¸åŠ¨æœºã€‚",
                color: "bg-purple-100",
                icon: "ğŸŒ€"
            },
            '7': {
                id: '7',
                name: "ä¸¹éƒ¨è½ Â· æ ¼è±é¢å…·",
                title: "è°ƒè§£å‹äººæ ¼ Â· å’Œå¹³åŸºç«™",
                trait: "å®é™",
                strength: "å‡èš",
                skill: "åŒ–å¹²æˆˆä¸ºç‰å¸›",
                desc: "ä½ æ‹¥æœ‰è®©å¯¹ç«‹åŒæ–¹å†·é™ä¸‹æ¥çš„é­”åŠ›ã€‚æ˜¯äººé™…å…³ç³»çš„æ¶¦æ»‘å‰‚ï¼Œæ€»èƒ½ç²¾å‡†æ‰¾åˆ°å…±è¯†ï¼Œè®©ä¸–ç•Œå› ä½ è€Œæ›´å›¢ç»“ã€‚",
                color: "bg-teal-100",
                icon: "ğŸ•Šï¸"
            },
            '8': {
                id: '8',
                name: "åº“å·´ç‹å›½ Â· å§†ç“¦ä»€Â·å®‰åšä¼Šé¢å…·",
                title: "é¢†è¢–å‹äººæ ¼ Â· å¤©é€‰è´µæ—",
                trait: "åä¸½",
                strength: "ç»Ÿå¾¡",
                skill: "åä¸½æ§åœº",
                desc: "ä½ çš„é­…åŠ›æ¥è‡ªä¸ç”Ÿä¿±æ¥çš„æ ¼å±€ä¸æ°”åœºã€‚æ— éœ€åˆ»æ„å¼ºè°ƒï¼Œå°±èƒ½æˆä¸ºäººç¾¤çš„ä¸­å¿ƒï¼ŒæŒ‡å¼•æ–¹å‘ï¼Œå¤©ç”Ÿå°±æ˜¯å¤§åœºé¢ç©å®¶ã€‚",
                color: "bg-yellow-100",
                icon: "ğŸ‘‘"
            },
            '9': {
                id: '9',
                name: "çº¦é²å·´éƒ¨è½ Â· ç›–è±å¾·é¢å…·",
                title: "æ²Ÿé€šå‹äººæ ¼ Â· å¹½é»˜è§‚å¯Ÿå®¶",
                trait: "è¯™è°",
                strength: "è­¦ä¸–",
                skill: "å¯“æ•™äºä¹",
                desc: "ä½ æ“…é•¿ç”¨å¹½é»˜åŒ…è£¹æ™ºæ…§ï¼Œåœ¨æ¬¢å£°ç¬‘è¯­ä¸­ç‚¹ç ´çœŸç›¸ã€‚æ˜¯æ´å¯Ÿäººæ€§çš„ç¤¾äº¤è‰ºæœ¯å®¶ï¼Œä½ çš„åæ§½æ€»è®©äººå¿ƒæœå£æœã€‚",
                color: "bg-blue-100",
                icon: "ğŸ‘ï¸"
            },
            '10': {
                id: '10',
                name: "æ½˜æ ¼å¨éƒ¨è½ Â· å¸ƒæ´›é¢å…·",
                title: "æ²»æ„ˆå‹äººæ ¼ Â· æœˆå…‰çµåŒ»",
                trait: "é€šé€",
                strength: "æŠšæ…°",
                skill: "æƒ…ç»ªSPA",
                desc: "ä½ æ•£å‘ç€æœˆå…‰èˆ¬æ¸©æŸ”è€Œå¼ºå¤§çš„æ²»æ„ˆåŠ›ã€‚èƒ½è½»æ˜“å…±æƒ…ï¼Œå€¾å¬å¹¶å‡€åŒ–è´Ÿèƒ½é‡ï¼Œæ˜¯æœ‹å‹ä¿¡èµ–çš„å¿ƒçµæŒ‰æ‘©å¸ˆã€‚",
                color: "bg-cyan-100",
                icon: "ğŸŒ™"
            },
        };

        let gameState = {
            currentWaypointIndex: 0,
            characterPosition: WAYPOINTS[0].pos,
            cameraY: 0,
            scene: 'INTRO',
            isMoving: false,
            answers: [],
            finalResult: null,
        };

        let targetIndex = 0;

        function renderGame() {
            const container = document.getElementById('gameContainer');
            
            if (gameState.scene === 'INTRO') {
                renderIntro(container);
            } else if (gameState.scene === 'QUIZ_STOP') {
                renderQuiz(container);
            } else if (gameState.scene === 'ENDING') {
                renderResult(container);
            } else {
                renderWalking(container);
            }
        }

        function renderIntro(container) {
            container.innerHTML = `
                <div class="absolute w-full h-full bg-notebook-paper transition-transform duration-500" style="transform: translateY(0px)">
                    <div class="absolute w-full top-[60px] flex flex-col items-center text-center px-6 z-20">
                        <h1 class="text-6xl font-hand font-black text-amber-900 mb-6 tracking-tighter mix-blend-multiply opacity-90">
                            é¢å…·ä¹‹é­‚
                        </h1>
                        <div class="font-hand text-amber-800 leading-relaxed max-w-sm mix-blend-multiply opacity-80 flex flex-col items-center">
                            <span class="block border-b-2 border-amber-900/10 pb-3 mb-3 text-3xl font-bold">æ¢å¯»ä½ çš„éæ´²éƒ¨è½åŒ–èº«</span>
                            <span class="text-xl font-normal">æµ‹æµ‹ä½ æ˜¯ä»€ä¹ˆç±»å‹çš„éæ´²éƒ¨è½é¢å…·</span>
                        </div>
                        
                        <button onclick="startGame()" class="mt-80 px-8 py-3 bg-[#fdfbf7] border-2 border-amber-900 text-amber-900 font-hand text-2xl rounded-sm shadow-[4px_4px_0px_0px_#5D4037] hover:bg-amber-50 active:shadow-none active:translate-x-1 active:translate-y-1 transition-all">
                            å¼€å§‹æ—…ç¨‹
                        </button>
                    </div>

                    <div class="absolute z-30" style="left: 50%; top: 320px; transform: translate(-50%, -90%);">
                        <div class="absolute bottom-1 left-1/2 -translate-x-1/2 w-8 h-3 bg-black/20 rounded-[100%] blur-[1.5px]"></div>
                        <div class="relative w-20 h-20">
                            ${getCharacterSVG(false)}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderQuiz(container) {
            const currentWaypointData = WAYPOINTS[gameState.currentWaypointIndex];
            const currentQuestion = QUESTIONS.find(q => q.id === currentWaypointData.questionId);
            
            let optionsHTML = '';
            for (let i = 0; i < currentQuestion.options.length; i++) {
                const opt = currentQuestion.options[i];
                optionsHTML += `
                    <button
                        onclick="selectAnswer('${opt.type}')"
                        class="w-full text-left p-4 bg-transparent border-2 border-stone-200 hover:border-amber-400 hover:bg-amber-50 transition-all font-hand text-lg text-amber-900 rounded-sm active:scale-[0.99]"
                    >
                        <span class="font-bold mr-2 text-amber-600">${opt.text.split('.')[0]}.</span>
                        ${opt.text.split('.').slice(1).join('.')}
                    </button>
                `;
            }
            
            container.innerHTML = `
                <div class="absolute inset-0 z-50 flex items-center justify-center p-4 bg-black/10 backdrop-blur-[1px] fade-in">
                    <div class="w-full max-w-md bg-[#fffdf5] p-6 border-2 border-amber-900 shadow-[8px_8px_0px_0px_rgba(60,40,30,0.15)] rounded-sm flex flex-col max-h-[85vh] relative transform rotate-1">
                        <div class="absolute -top-3 left-1/2 -translate-x-1/2 w-24 h-6 bg-amber-400/30 rotate-[-2deg] shadow-sm backdrop-blur-sm"></div>

                        <div class="text-amber-800/40 text-xs font-bold uppercase tracking-widest mb-4 text-center shrink-0 font-hand">
                            Checkpoint ${currentQuestion.id}
                        </div>
                        
                        <div class="overflow-y-auto mb-6 shrink-0 text-center">
                            <h3 class="text-2xl font-hand font-bold text-amber-950 leading-tight">
                                ${currentQuestion.text}
                            </h3>
                        </div>

                        <div class="space-y-3 overflow-y-auto flex-1 pr-1">
                            ${optionsHTML}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderResult(container) {
            const result = RESULTS[gameState.finalResult];
            
            container.innerHTML = `
                <div class="absolute inset-0 z-50 flex items-center justify-center bg-[#fdfbf7]/95 fade-in">
                    <div class="w-full h-full max-w-md overflow-y-auto p-6 flex flex-col items-center justify-center">
                        <div class="w-full bg-white border-2 border-amber-950 p-6 shadow-[10px_10px_0_0_rgba(0,0,0,0.05)] rounded-sm relative shrink-0 transform -rotate-1">
                            <div class="absolute -top-4 right-10 w-24 h-8 bg-red-400/20 rotate-3 backdrop-blur-sm"></div>

                            <div class="text-center mb-6 mt-4">
                                <div class="text-7xl mb-4 opacity-90 mix-blend-multiply">${result.icon}</div>
                                <h2 class="text-2xl md:text-3xl font-bold font-hand text-amber-900 leading-none mb-2">
                                    ${result.name}
                                </h2>
                                ${result.tribe ? `<div class="text-sm text-amber-600 mb-2">${result.tribe}</div>` : ''}
                                <div class="w-full h-px bg-amber-900/20 my-3"></div>
                                <h3 class="text-lg font-hand text-amber-700 italic">
                                    ${result.title}
                                </h3>
                            </div>

                            <div class="grid grid-cols-3 gap-2 text-center font-hand text-sm text-amber-900 mb-6 bg-stone-50 p-3 rounded border border-dashed border-stone-300">
                                <div class="flex flex-col justify-center">
                                    <div class="opacity-50 text-[10px] uppercase mb-1">ç‰¹è´¨</div>
                                    <span class="font-bold">${result.trait}</span>
                                </div>
                                <div class="border-l border-r border-stone-200 px-1 flex flex-col justify-center">
                                    <div class="opacity-50 text-[10px] uppercase mb-1">ä¼˜åŠ¿</div>
                                    <span class="font-bold">${result.strength}</span>
                                </div>
                                <div class="flex flex-col justify-center">
                                    <div class="opacity-50 text-[10px] uppercase mb-1">æ‹¿æ‰‹å¥½æˆ</div>
                                    <span class="font-bold">${result.skill}</span>
                                </div>
                            </div>

                            <p class="text-center font-hand text-amber-950 text-lg leading-relaxed mb-8 px-2">
                                ${result.desc}
                            </p>
                            
                            <button 
                                onclick="resetGame()"
                                class="w-full py-4 bg-amber-900 text-white font-bold font-hand text-xl rounded shadow hover:bg-amber-800 transition-colors flex items-center justify-center gap-2 group active:scale-95"
                            >
                                <span>ğŸ”„</span> 
                                <span>å†æµ‹ä¸€æ¬¡</span>
                            </button>
                        </div>

                        <div class="mt-8 text-amber-900/30 font-hand text-sm text-center pb-8">
                            Mask Soul Personality Test
                        </div>
                    </div>
                </div>
            `;
        }

        function renderWalking(container) {
            container.innerHTML = `
                <div class="absolute w-full h-full bg-notebook-paper transition-transform duration-500" style="transform: translateY(-${gameState.cameraY}px); height: ${WORLD_HEIGHT}px">
                    <div class="absolute z-30" style="left: ${gameState.characterPosition.x}%; top: ${gameState.characterPosition.y}px; transform: translate(-50%, -90%);">
                        <div class="absolute bottom-1 left-1/2 -translate-x-1/2 w-8 h-3 bg-black/20 rounded-[100%] blur-[1.5px]"></div>
                        <div class="relative w-20 h-20 ${gameState.isMoving ? 'animate-bounce-move' : ''}">
                            ${getCharacterSVG(gameState.isMoving)}
                        </div>
                    </div>
                </div>
            `;
        }

        function getCharacterSVG(isAnimating) {
            return `
                <svg viewBox="0 0 100 100" class="w-full h-full drop-shadow-md">
                    <g>
                        <g style="transform-origin: 45px 75px" class="${isAnimating ? 'animate-leg' : ''}">
                            <path d="M45 75 L45 95" stroke="#8D5524" stroke-width="6" stroke-linecap="round" />
                        </g>
                        <g style="transform-origin: 40px 55px" class="${isAnimating ? 'animate-arm' : ''}">
                            <path d="M40 55 L30 65" stroke="#8D5524" stroke-width="5" stroke-linecap="round" />
                        </g>
                        <path d="M36 70 L42 85 L48 70" fill="#b45309" />
                        <path d="M42 70 L48 85 L54 70" fill="#b45309" />
                        <rect x="38" y="48" width="24" height="26" rx="4" fill="#8D5524" />
                        <path d="M38 48 L38 72 L46 72 L46 48 Z" fill="#9a3412" />
                        <path d="M54 48 L54 72 L62 72 L62 48 Z" fill="#9a3412" />
                        <g style="transform-origin: 55px 75px" class="${isAnimating ? 'animate-leg-opp' : ''}">
                            <path d="M55 75 L55 95" stroke="#8D5524" stroke-width="6" stroke-linecap="round" />
                        </g>
                        <path d="M34 72 L38 88 L42 75 L46 88 L50 75 L54 88 L58 75 L62 88 L66 72" fill="#eab308" stroke="#a16207" stroke-width="1" stroke-linejoin="round" />
                        <path d="M34 72 L66 72" stroke="#713f12" stroke-width="3" stroke-linecap="round" />
                        <circle cx="50" cy="38" r="17" fill="#8D5524" />
                        <path d="M33 32 Q50 22 67 32" stroke="#fbbf24" stroke-width="3" fill="none" />
                        <path d="M44 22 L40 5 L48 15" fill="#ef4444" />
                        <circle cx="54" cy="36" r="2" fill="#1a1a1a" />
                        <circle cx="62" cy="36" r="2" fill="#1a1a1a" />
                        <path d="M52 42 L56 44" stroke="#fff" stroke-width="2" opacity="0.6" stroke-linecap="round" />
                        <path d="M60 42 L64 44" stroke="#fff" stroke-width="2" opacity="0.6" stroke-linecap="round" />
                        <g style="transform-origin: 60px 55px" class="${isAnimating ? 'animate-arm-opp' : ''}">
                            <path d="M60 55 L70 65" stroke="#8D5524" stroke-width="5" stroke-linecap="round" />
                        </g>
                    </g>
                </svg>
            `;
        }

        function startGame() {
            targetIndex = 1;
            moveCharacter();
        }

        function moveCharacter() {
            if (gameState.currentWaypointIndex === targetIndex) {
                gameState.isMoving = false;
                
                const currentPoint = WAYPOINTS[gameState.currentWaypointIndex];
                if (currentPoint.questionId && gameState.scene !== 'QUIZ_STOP') {
                    gameState.scene = 'QUIZ_STOP';
                }
                
                if (currentPoint.isEnd && gameState.scene !== 'ENDING') {
                    calculateResult();
                }
                
                renderGame();
                return;
            }

            const nextIndex = gameState.currentWaypointIndex + 1;
            const startPos = WAYPOINTS[gameState.currentWaypointIndex].pos;
            const endPos = WAYPOINTS[nextIndex].pos;
            
            let progress = 0;
            const speed = 0.02;

            function animate() {
                progress += speed;
                if (progress >= 1) progress = 1;

                const newX = startPos.x + (endPos.x - startPos.x) * progress;
                const newY = startPos.y + (endPos.y - startPos.y) * progress;

                const viewportHeight = window.innerHeight;
                let targetCameraY = newY - (viewportHeight * 0.5);
                if (targetCameraY < 0) targetCameraY = 0;
                if (targetCameraY > WORLD_HEIGHT - viewportHeight) targetCameraY = WORLD_HEIGHT - viewportHeight;

                gameState.characterPosition = { x: newX, y: newY };
                gameState.cameraY = targetCameraY;
                gameState.scene = 'WALKING';
                gameState.isMoving = true;

                if (progress < 1) {
                    renderGame();
                    requestAnimationFrame(animate);
                } else {
                    gameState.currentWaypointIndex = nextIndex;
                    animate();
                }
            }

            animate();
        }

        function selectAnswer(type) {
            gameState.answers.push(type);
            gameState.scene = 'WALKING';
            targetIndex++;
            moveCharacter();
        }

        function calculateResult() {
            const counts = { A: 0, B: 0, C: 0, D: 0 };
            gameState.answers.forEach(a => {
                if (counts[a] !== undefined) counts[a]++;
            });

            const maxScore = Math.max(counts.A, counts.B, counts.C, counts.D);
            
            if (counts.A === counts.B && counts.B === counts.C && counts.C === counts.D) {
                gameState.finalResult = '7';
            } else {
                let dominant = '';
                if (counts.A === maxScore) dominant = 'A';
                else if (counts.B === maxScore) dominant = 'B';
                else if (counts.C === maxScore) dominant = 'C';
                else dominant = 'D';

                let possibleResults = [];
                if (dominant === 'A') possibleResults = ['1', '5'];
                if (dominant === 'B') possibleResults = ['3', '8'];
                if (dominant === 'C') possibleResults = ['4', '7', '9'];
                if (dominant === 'D') possibleResults = ['2', '6', '10'];

                const hash = gameState.answers.join('').split('').reduce((acc, char) => acc + char.charCodeAt(0), 0);
                gameState.finalResult = possibleResults[hash % possibleResults.length];
            }

            gameState.scene = 'ENDING';
            renderGame();
        }

        function resetGame() {
            gameState = {
                currentWaypointIndex: 0,
                characterPosition: WAYPOINTS[0].pos,
                cameraY: 0,
                scene: 'INTRO',
                isMoving: false,
                answers: [],
                finalResult: null,
            };
            targetIndex = 0;
            renderGame();
        }

        document.addEventListener('DOMContentLoaded', function() {
            renderGame();
        });

        window.startGame = startGame;
        window.selectAnswer = selectAnswer;
        window.resetGame = resetGame;
        window.moveCharacter = moveCharacter;
    </script>
</body>
</html>